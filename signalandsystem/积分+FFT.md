- [时域积分对频域的影响](#时域积分对频域的影响)
- [直接采样做FFT的数学原理](#直接采样做fft的数学原理)
- [采样后做积分再FFT的数学原理](#采样后做积分再fft的数学原理)
  - [频域影响](#频域影响)
  - [从系统理论角度分析](#从系统理论角度分析)
  - [时域特性变化](#时域特性变化)
- [**相干积分的数学原理**](#相干积分的数学原理)
  - [频域影响](#频域影响-1)
  - [**总结**](#总结)
- [非相干累加的数学原理](#非相干累加的数学原理)
  - [相干积分与非相干累加的区别](#相干积分与非相干累加的区别)
    - [处理阶段不同](#处理阶段不同)
    - [相位敏感性](#相位敏感性)
    - [信噪比改善机制](#信噪比改善机制)
  - [组合使用的原理](#组合使用的原理)
  - [应用场景](#应用场景)
  - [总结](#总结-1)
- [积分增加信噪比的原理](#积分增加信噪比的原理)



## 时域积分对频域的影响

假设时域信号 $x(t)$ 经过积分操作，其结果为：

$$
y(t) = \int_{-\infty}^{t} x(\tau)\, d\tau
$$

根据傅里叶变换的性质，时域积分对应于频域中将信号的频谱乘以因子：

$$
\frac{1}{j\omega}
$$

也就是说，若 $X(\omega)$ 是 $x(t)$ 的傅里叶变换，则 $y(t)$ 的傅里叶变换为：

$$
Y(\omega) = \frac{1}{j\omega} X(\omega)
$$

这带来了以下几个影响：

1. **低通滤波效果**  
   由于 
   $$
   \left|\frac{1}{j\omega}\right| = \frac{1}{|\omega|}
   $$
   当 $\omega$ 较大时，该因子的幅值减小，导致高频成分被衰减，而低频成分则相对保留或被放大。

2. **相位变化**  
   乘以 $\frac{1}{j\omega}$ 会为每个频率分量引入一个固定的相移，理论上为 $-90^\circ$（即 $-\pi/2$），这反映了积分操作对信号的累积相位效应。

综上所述，时域上的积分操作在频域中起到了类似低通滤波的作用，既平滑了信号，也强调了低频成分，同时对所有频率分量施加了一个固定的相位延迟。


## 直接采样做FFT的数学原理

当我们直接对采样信号 $x(n)$ 做 FFT 时，我们实际上是在计算：

$$
X(k) = \sum_{n=0}^{N-1} x(n) \cdot e^{-j\frac{2\pi kn}{N}}
$$

其中：

- $N$ 是采样点数
- $k$ 是频率索引 $(k = 0, 1, ..., N-1)$
- $X(k)$ 是信号在频域中的复数表示

这个变换将时域信号映射到频域，保留了原始信号的所有频率特性。FFT 结果反映了信号中不同频率成分的幅度和相位信息。

---

## 采样后做积分再FFT的数学原理

当我们对采样后的信号先做积分再做 FFT 时，实际上是对原始信号引入了一个额外的变换。具体来说，假设积分操作表示为 $y(n)$，那么：

$$
y(n) = \sum_{m=0}^{n} x(m)
$$

然后对 $y(n)$ 进行 FFT：

$$
Y(k) = \sum_{n=0}^{N-1} y(n) \cdot e^{-j\frac{2\pi kn}{N}}
$$

### 频域影响

从传递函数角度看，积分相当于引入了一个 $\frac{1}{j\omega}$的传递函数（在连续域）。在离散域中，这相当于引入了一个低通滤波器，会强调信号中的低频成分。

- **频率响应变化**：
  - 积分操作在频域相当于频谱乘以 $\frac{1}{j\omega}$
  - 这会强调低频成分，减弱高频成分，相当于对信号施加了一个低通滤波器

- **线性相位特性**：
  - 积分会引入累积相位变化
  - 线性积分引入的是 $-90^\circ$ 的相移

### 从系统理论角度分析

积分操作可以看作是一个系统，其传递函数为：

$$
H(z) = \frac{1}{1 - z^{-1}}
$$

---

### 时域特性变化

- 原始信号的快速变化（高频成分）会被平滑
- 信号的整体趋势（低频成分）会被强调

---

## **相干积分的数学原理**

相干积分是一种特殊类型的积分，主要用于处理周期性信号。假设信号周期为 $P$，则相干积分可表示为：

$$
y(n) = \frac{1}{M} \sum_{m=0}^{M-1} x(n + mP)
$$

其中 $M$ 是积分周期数。这实际上是对多个相同周期的信号段进行平均。

### 频域影响

在频域中，相干积分会：

- **增强周期为 $P$ 的频率成分**
- **减弱非周期成分（如随机噪声）**

---

### **总结**

是的，采样后做积分再 FFT 确实会改变数据的性质。这种改变主要体现在：

1. **频谱响应的变化**（低频增强，高频抑制）
2. **相位信息的变化**
3. **信号-噪声比的潜在提高**（对于周期信号）



## 非相干累加的数学原理

在信号处理中，**非相干累加**通常指对频谱幅度或功率谱的累加，而不是对原始时域信号的累加。假设我们有多个信号段，每个信号段经过 FFT 后得到的频谱为 $|X_i(k)|$，则非相干累加可表示为：

- **功率谱累加**：

  $$
  Y(k) = \frac{1}{L} \sum_{i=0}^{L-1} |X_i(k)|^2
  $$

- **幅度谱累加**：

  $$
  Y(k) = \frac{1}{L} \sum_{i=0}^{L-1} |X_i(k)|
  $$

其中：

- $L$ 是非相干累加的次数  
- $|X_i(k)|$ 是第 $i$ 个信号段的 FFT 幅度谱  
- $|X_i(k)|^2$ 则表示功率谱

---

### 相干积分与非相干累加的区别

#### 处理阶段不同

- **相干积分**：在时域进行，对原始信号样本直接累加  
- **非相干累加**：在频域进行，对 FFT 后的功率谱或幅度谱进行累加

#### 相位敏感性

- **相干积分**：保留相位信息，要求信号相位对齐  
- **非相干累加**：忽略相位信息，只关注幅度或功率

#### 信噪比改善机制

- **相干积分**：信号幅度增加正比于累加次数 $M$，噪声幅度增加正比于 $\sqrt{M}$，因此 SNR 提高 $\sqrt{M}$ 倍  
- **非相干累加**：信号功率保持不变，噪声功率降低正比于累加次数 $L$，因此 SNR 提高 $\sqrt{L}$ 倍

---

### 组合使用的原理

在实际应用中，相干积分和非相干累加常常组合使用：

1. **相干积分**：首先对时域信号进行相干积分，增强周期性信号成分  
2. **FFT**：然后对每个积分后的信号段做 FFT  
3. **非相干累加**：最后对多个 FFT 结果的功率谱进行非相干累加

这种组合方法的累积 SNR 增益理论上为 $\sqrt{M \cdot L}$，其中 $M$ 是相干积分次数，$L$ 是非相干累加次数。

---

### 应用场景

非相干累加特别适用于：

- 信号相位不稳定或难以精确对齐的情况  
- 需要检测未知频率的微弱信号  
- 减少频谱估计的方差，使频谱更平滑

---

### 总结

非相干累加是在频域对功率谱或幅度谱进行叠加平均的处理，它与时域的相干积分相互补充。两者结合使用，能够最大限度地提高信号检测能力，特别是对于淹没在噪声中的弱信号。非相干累加的次数 $L$ 是一个重要参数，它决定了处理后的频谱统计特性和最终的信噪比提升程度。


## 积分增加信噪比的原理

信号进行积分可以增加信噪比（SNR），主要原因在于积分过程能够**累积信号能量**而**部分抵消随机噪声**的影响。具体解释如下：

1. **信号的相干累加**  
   如果信号的相位是已知且一致的（相干），那么对信号进行积分（或相干累加）时，各个时刻的信号成分将会**线性累加**。假设有 \(N\) 个样本，每个样本的信号幅度为 \(A\)，那么积分后的信号幅度大约为：
   $$
   A_{\text{signal}} \propto N \cdot A
   $$

2. **噪声的随机叠加**  
   噪声通常具有随机的相位和幅度，其累加过程类似于随机游走。对于 $N$ 个独立的噪声样本，其总噪声幅度的均方根（RMS）增长约为：
   $$
   A_{\text{noise}} \propto \sqrt{N} \cdot \sigma
   $$
   其中 $\sigma$ 是单个噪声样本的标准差。

3. **SNR的提升**  
   因此，相干积分后的信号与噪声的比值为：
   $$
   \text{SNR}_{\text{integrated}} \propto \frac{N \cdot A}{\sqrt{N} \cdot \sigma} = \sqrt{N} \cdot \frac{A}{\sigma}
   $$
   可以看出，SNR 会提升大约 $\sqrt{N}$ 倍。

4. **积分的低通滤波作用**  
   积分操作在频域上相当于将信号乘以 $\frac{1}{j\omega}$（忽略相位因素），这会**衰减高频噪声**，进一步改善SNR。

综上所述，通过积分，信号的有用部分由于相干性得到了线性增强，而随机噪声则仅以平方根速度增加，最终实现信噪比的提升。
