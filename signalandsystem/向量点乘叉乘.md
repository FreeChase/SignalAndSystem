# 向量点乘与叉乘求角原理

本文介绍如何利用向量的**点乘**（内积）与**叉乘**（外积）来求出两个向量之间的夹角及其几何意义。

---

## 0. 向量正交基



我们可以通过数学方法，把任何一组线性无关的向量变成相互正交的基向量。

这就是著名的：

**Gram-Schmidt 正交化**(Gram-Schmidt Orthogonalization)算法。

它的意义是：

- 你给我任意一组基；  
- 我可以用代数手段变换出一组方向相互垂直的基；  
- 它们仍然张成同一个空间。

因此我们常常选择“正交基”来简化运算。


在四维欧几里得空间 $\mathbb{R}^4$ 中，一个标准正交基可以写为：

$$
e_1 = (1,0,0,0), \quad
e_2 = (0,1,0,0), \quad
e_3 = (0,0,1,0), \quad
e_4 = (0,0,0,1)
$$

它们满足：

$$
e_i \cdot e_j =
\begin{cases}
1, & i = j \\
0, & i \neq j
\end{cases}
$$

这表示：

- 每个基向量都有自己的“方向”（独立维度）；  
- 任意两个基向量的方向彼此正交（垂直），没有重叠分量。

## 1. 向量的点乘与夹角

### 1.1 代数定义

设有两个向量  
$$
\vec{a} = (a_1, a_2, \dots, a_n) \quad \text{和} \quad \vec{b} = (b_1, b_2, \dots, b_n)
$$  
它们的点乘定义为  
$$
\vec{a} \cdot \vec{b} = a_1b_1 + a_2b_2 + \cdots + a_nb_n
$$
> n维欧几里得空间$\mathbb{R}^n$中的两个向量
### 1.2 几何定义

几何上，点乘反映了两个向量在方向上的“相似度”，其定义为：
$$
\vec{a} \cdot \vec{b} = |\vec{a}|\,|\vec{b}| \cos\theta
$$
其中：
- $|\vec{a}|$ 和 $|\vec{b}|$ 分别是向量的模（长度），
- $\theta$ 为两向量之间的夹角。

### 1.3 求角公式

由上述几何定义可得：
$$
\cos\theta = \frac{\vec{a} \cdot \vec{b}}{|\vec{a}|\,|\vec{b}|}
$$
因此，夹角 $\theta$ 可表示为：
$$
\theta = \arccos\left(\frac{\vec{a} \cdot \vec{b}}{|\vec{a}|\,|\vec{b}|}\right)
$$
这种方法适用于计算 $0^\circ$ 到 $180^\circ$ 范围内的夹角。

---

## 2. 向量的叉乘与求角

### 2.1 代数定义

对于三维空间中的向量  
$$
\vec{a} = (a_x, a_y, a_z),\quad \vec{b} = (b_x, b_y, b_z)
$$
其叉乘定义为：
$$
\vec{a} \times \vec{b} = \Big(a_yb_z - a_zb_y,\; a_zb_x - a_xb_z,\; a_xb_y - a_yb_x\Big)
$$

### 2.2 几何意义

- **模长**：叉乘的模长为  
  $$
  |\vec{a} \times \vec{b}| = |\vec{a}|\,|\vec{b}| \sin\theta
  $$
  表示以 $\vec{a}$ 和 $\vec{b}$ 为边构成的平行四边形的面积。
  
- **方向**：叉乘的方向垂直于 $\vec{a}$ 和 $\vec{b}$ 所在的平面，其方向由右手定则确定。

### 2.3 利用叉乘求角

由于同时有
$$
\begin{cases}
\vec{a} \cdot \vec{b} = |\vec{a}|\,|\vec{b}| \cos\theta, \\
|\vec{a} \times \vec{b}| = |\vec{a}|\,|\vec{b}| \sin\theta,
\end{cases}
$$

因此可利用反正切函数求夹角：

$$
\tan\theta = \frac{|\vec{a} \times \vec{b}|}{\vec{a} \cdot \vec{b}},
$$

进而得：

$$
\theta = \arctan\!\left(\frac{|\vec{a} \times \vec{b}|}{\vec{a} \cdot \vec{b}}\right).
$$


> **注意**：这种方法利用了 $\tan\theta = \frac{\sin\theta}{\cos\theta}$。  
> 为了避免除以零和丢失象限信息，在实际编程中常用 **atan2** 函数：
> $$
> \theta = \operatorname{atan2}\left(|\vec{a} \times \vec{b}|,\; \vec{a} \cdot \vec{b}\right)
> $$
> 其中第一个参数为“对边”（与 $\sin\theta$ 相关），第二个参数为“邻边”（与 $\cos\theta$ 相关），可以返回 $-\pi$ 到 $\pi$ 之间的角度，并正确判断象限。

---

## 3. 原理总结

- **点乘**给出的是 $\cos\theta$（乘以模长的乘积），用来求解两个向量之间的夹角（通过 $\arccos$）。
- **叉乘**给出的是 $\sin\theta$（乘以模长的乘积），其模长等于以两向量为边的平行四边形面积。
- 利用点乘和叉乘的关系，可以通过
  $$
  \tan\theta = \frac{|\vec{a} \times \vec{b}|}{\vec{a} \cdot \vec{b}}
  $$
  来求解夹角，从而使用 $\arctan$ 或更稳健的 $\operatorname{atan2}$ 函数。

这种方法不仅理论上解释了向量之间的角度关系，同时也为数值计算提供了高效且稳健的实现方案。

---

# 导航中的利用

在导航或定位系统（如GPS接收机）中，经常需要对载波或码信号进行跟踪，这通常采用闭环系统（如锁相环PLL和延迟锁定环DLL）。在这些系统里，一个常见的方法是将信号与本地产生的参考信号进行相关运算，这里会产生两个正交（互相90°）的输出分量，我们可以形象地称为“积分量”——通常分别对应着**点乘分量**（In‑phase，I分量）和**叉乘分量**（Quadrature，Q分量）。

下面简要说明它们之间的关系和作用：

- **点乘（内积）**  
  - 数学表达式：  
    $$
    \vec{a} \cdot \vec{b} = |\vec{a}|\,|\vec{b}| \cos\theta
    $$
  - 在跟踪中，点乘运算得到的结果反映了两个信号之间的“相干”程度，其输出（经过滤波、积分）产生的I分量代表相位上与参考信号同相的部分。

- **叉乘（外积）**  
  - 数学表达式（在二维可用简化形式表示为）：  
    $$
    |\vec{a} \times \vec{b}| = |\vec{a}|\,|\vec{b}| \sin\theta
    $$
  - 叉乘在此中的作用是捕捉信号与参考信号之间的“正交”信息，经过滤波和积分后得到Q分量，它反映了载波（或码）相位之间存在90°相位差的那部分信息。

- **两个积分量（I与Q）**  
  - 在导航信号处理流程中，通过将接收信号与本地参考信号做相关运算，分别以：
    - **点乘方式**（即“内积”）得到 I 分量，该分量与 $\cos\theta$ 有关，
    - **叉乘方式**（或正交相关）得到 Q 分量，该分量与 $\sin\theta$ 有关。
  - 这两个正交输出经过积分滤波以后，可以通过计算：
    $$
    \theta = \operatorname{atan2}(Q, I)
    $$
    得到准确的相位误差（或者说相位差），进而用于调整本地振荡器（通过数控振荡器NCO），使得系统能够紧跟信号变化。

- **总结关系**  
  - **点乘** 提供信号在参考方向上的投影（I分量），反映 $\cos\theta$ 的信息。  
  - **叉乘**（或其对应的正交相关）提供了与参考方向正交的部分（Q分量），反映 $\sin\theta$ 的信息。  
  - 经过积分器后，这两个“积分量”用于构成闭环跟踪中的误差信号，进而生成控制字（例如载波控制字或码控制字）去调整本地产生的信号，使其与接收的信号保持一致。

这种利用点乘与叉乘获得两个正交积分量，再用 $\operatorname{atan2}(Q, I)$ 计算相位误差的原理，是导航信息中常见的相干跟踪技术的核心思想。

